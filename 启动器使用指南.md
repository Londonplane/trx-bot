# 🚀 TRON 能量助手启动器使用指南

## ⚡ 快速开始

### 🎯 推荐方式（一劳永逸）

```bash
python launcher.py
```

**这是全新的生产级启动器，彻底解决了所有问题：**
- ✅ 完全解决 Windows 编码问题
- ✅ 自动故障检测和重启（最多3次）
- ✅ 实时健康监控
- ✅ 优雅的进程管理
- ✅ 无输出重定向问题

### 📱 启动器特性

```
🚀 TRON 能量助手 - 生产级启动器
✨ 特性: 自动重启、健康监控、编码兼容

🎉 TRON 能量助手已成功启动！

📊 服务状态:
  🌐 后端API: http://localhost:8002 (PID: 12345)
  🤖 Telegram Bot: 运行中 (PID: 12346)

💡 功能特性:
  ✅ 自动故障检测和重启
  ✅ 服务健康监控
  ✅ 优雅关闭处理
  ✅ 编码问题完全解决

🎮 控制说明:
  📊 查看状态: 访问 http://localhost:8002/health
  🛑 停止服务: 按 Ctrl+C
```

## 🔧 技术特性

### 🛡️ 编码问题解决方案

1. **全局编码修复**：`encoding_fix.py` 模块
2. **控制台编码设置**：自动设置 UTF-8 (代码页 65001)
3. **环境变量配置**：`PYTHONIOENCODING=utf-8`
4. **输出流重包装**：安全的 UTF-8 输出处理

### 🔄 进程管理

1. **生产级进程管理器**：`ProcessManager` 类
2. **智能重启机制**：最多 3 次自动重启
3. **健康检查**：HTTP 端点监控
4. **优雅关闭**：正确的信号处理

### 📊 监控功能

1. **实时进程监控**：每 3 秒检查一次
2. **退出码报告**：详细的故障信息
3. **重启计数器**：防止无限重启循环
4. **状态报告**：清晰的服务状态显示

## 🔄 从旧启动器迁移

### 旧方式（有问题）
```bash
python start_all.py  # 编码问题、进程不稳定
```

### 新方式（完美解决）
```bash
python launcher.py   # 生产级、稳定、无编码问题
```

## 🐛 问题排查

### 如果服务无法启动：

1. **检查端口占用**：
   ```bash
   netstat -ano | findstr :8002
   ```

2. **检查 Python 环境**：
   ```bash
   python --version
   pip list
   ```

3. **手动测试**：
   ```bash
   # 测试后端
   cd backend && python main.py
   
   # 测试 Bot
   python main.py
   ```

### 如果出现编码错误：

新启动器已经完全解决编码问题，如果仍有问题：

1. **重启命令行窗口**
2. **确保使用 `python launcher.py`**
3. **检查 `encoding_fix.py` 是否存在**

## 🎯 最佳实践

### ✅ 推荐操作

```bash
# 1. 使用新启动器
python launcher.py

# 2. 查看服务状态
curl http://localhost:8002/health

# 3. 优雅停止
# 按 Ctrl+C（自动处理所有清理工作）
```

### ❌ 避免操作

```bash
# 不要再使用旧启动器
python start_all.py  # 已过时

# 不要强制杀死进程
taskkill /f /im python.exe  # 可能导致数据丢失
```

## 🔮 特性预览

- 🔄 **自动重启**：服务崩溃时自动恢复
- 🏥 **健康监控**：持续监控服务状态
- 📱 **状态报告**：实时显示系统状态
- 🛡️ **编码兼容**：完美支持中文和 Emoji
- ⚡ **即时启动**：优化的启动流程
- 🎮 **易于控制**：简单的启停操作

---

## 💡 小贴士

1. **推荐在新命令行窗口中运行启动器**
2. **服务启动需要几秒钟，请耐心等待**
3. **可以通过浏览器访问 http://localhost:8002 查看 API 文档**
4. **使用 Ctrl+C 可以优雅地停止所有服务**

**现在就试试新启动器，享受稳定无忧的体验！** 🎉